# .cursorrules

## ðŸŽ¯ Purpose

These are the baseline rules and norms that the AI assistant should always follow when generating or refactoring code in this project.  
These apply unless an explicit exception is requested.

---

## 1. Main Principles

- Prioritize **readability**, **maintainability**, and **reusability**.
- Follow **DRY (Don't Repeat Yourself)** and **Single Responsibility** principles.
- Design for **modularity**: small, focused modules with minimal coupling.
- Use **strong typing** (in TypeScript). Avoid `any` unless absolutely necessary.
- Write **self-documenting** code with meaningful names and clear boundaries.
- Add comments when logic is not obvious.
- Prefer **composition** over inheritance.

---

## 2. Project Structure & Naming Conventions

### Folder Structure

This is an **Astro** project with the following structure:

```
scripts/           # Scripts for GitHub Actions or local commands
src/
â”œâ”€â”€ components/    # Reusable Astro/UI components (PascalCase)
â”‚   â”œâ”€â”€ about/     # About page specific components
â”‚   â”œâ”€â”€ common/    # Shared common components
â”‚   â””â”€â”€ podcast/   # Podcast-related components
â”œâ”€â”€ constants/     # Constant definitions (e.g., actors.ts, podcastUrls.ts)
â”œâ”€â”€ layouts/       # Astro layout files used by pages
â”œâ”€â”€ pages/         # Astro pages (file-based routing)
â”œâ”€â”€ types/         # TypeScript type definitions
â””â”€â”€ utils/         # Shared utility functions (imported by pages, components, AND scripts)
```

### Naming Rules

- **Astro Components** â†’ `PascalCase.astro` (e.g., `EpisodeCard.astro`)
- **TypeScript Components** â†’ `PascalCase.tsx` (e.g., `Modal.tsx`)
- **Utils** â†’ `camelCase.ts` or descriptive names (e.g., `formatDate.ts`, `xmlParser.ts`)
- **Types** â†’ `*.types.ts` or `index.ts` in types folder
- **Constants** â†’ `camelCase.ts` (e.g., `actors.ts`, `podcastUrls.ts`)
- **Scripts** â†’ `kebab-case.ts` (e.g., `cleanup-old-rss-files.ts`)
- **Folder names** â†’ plural nouns or descriptive (e.g., `components`, `utils`)
- **Avoid deep nesting** unless it improves organization

---

## 3. Code Style / Formatting

- Follow Prettier and ESLint configuration in the repo.
- Maintain consistent formatting and linting compliance.
- Use 2-space indentation, limit lines to ~100â€“120 chars.
- **Order imports alphabetically** for consistency.
- **Remove unnecessary imports** to keep files clean.
- Prefer consistency within the file/project over arbitrary preferences.

---

## 4. TypeScript & API Design

- Always use **strict mode**.
- Prefer explicit, strongly typed interfaces.
- Use `interface` for extendable shapes, `type` for unions/intersections.
- Use `readonly` and `as const` when possible.
- Avoid `any`; prefer generics or `unknown`.
- For APIs and external services:
  - Keep endpoints clear and domain-focused.
  - Decouple network logic from UI components.
  - Place API interaction logic in `src/utils/` organized by service (e.g., `spotify/`, `youtube/`, `x/`).

---

## 5. Testing & Quality

- Write unit tests for core logic and integration tests for major features.
- Code generated by AI should include or suggest appropriate tests.
- Tests should mirror production code style and structure.
- Prefer testable, pure functions in `src/utils/`.

---

## 6. Refactoring & Commonization

**This is critical for this project:**

- **Extract shared logic** into `src/utils/` modules.
- **Never leave utility functions or reusable logic directly in page, component, or script files.**
- **Scripts in `scripts/` should import utilities from `src/utils/`** rather than defining them inline.
- Reuse existing functions and components before creating new ones.
- When duplication is found, AI should suggest refactoring for reuse.
- Prefer small, focused functions that do one thing well.
- Place reusable components in `src/components/`.
- Place constants in `src/constants/`.

### Example

**âŒ Bad:** Defining utility function in script file
```typescript
// scripts/some-script.ts
function parseDate(filename: string): Date { ... }
```

**âœ… Good:** Import utility from src/utils/
```typescript
// scripts/some-script.ts
import { parseTimestampFromFilename } from '../src/utils/formatters.js';
```

---

## 7. Astro-Specific Guidelines

- Use `.astro` files for components that need Astro's features (frontmatter, component scripts, etc.).
- Use `.tsx` files for pure TypeScript/framework components if needed.
- Keep Astro component scripts in the frontmatter (between `---` delimiters).
- For complex logic, extract it to `src/utils/` and import it.
- Layouts in `src/layouts/` should be reusable across pages.
- Pages in `src/pages/` follow file-based routing.

---

## 8. Scripts & Automation

- Scripts in `scripts/` are used by GitHub Actions and local commands.
- Scripts should be self-contained executables using `npx tsx`.
- **Always import utilities from `src/utils/`** rather than defining logic inline.
- Scripts should have clear logging and error handling.
- **Use `createLogger` from `src/utils/logger.js`** instead of `console.log` for consistent, formatted output.
- Scripts should follow the same TypeScript best practices as application code.

---

## 9. Collaboration & AI Usage

- The AI should favor **clarity over cleverness**.
- Ask for clarification before breaking a project convention.
- The AI should default to these rules without being reminded.
- Keep generated code concise, clean, and easy to review.
- Do not generate large, monolithic components or deeply nested functions.

---

## 10. Exceptions & Pragmatism

- Rules are guidelines, not dogma.
- The AI can deviate for justified reasons but must mention the rationale.
- Prefer consistency and maintainability above all.

---

## 11. Documentation & Onboarding

- Generate JSDoc comments for exported functions, types, and components.
- Update or suggest changes to README or documentation files when creating new modules.
- Each utility module should have a short summary of purpose and usage.
- Document complex logic that isn't immediately obvious.

---

## 12. Versioning & Deprecation

- Mark deprecated utilities clearly with `@deprecated` JSDoc tag.
- Suggest migration paths when replacing functions or modules.
- Keep module interfaces stable; avoid breaking changes without reason.

---

## âœ… Summary

When using Cursor:

> "Generate or refactor code according to our .cursorrules."

The AI should automatically:

- Promote **reuse and modularity**.
- Extract utilities to `src/utils/`, components to `src/components/`, constants to `src/constants/`.
- Follow **TypeScript best practices** with strong typing.
- Maintain a **consistent, clean, and testable codebase**.
- Write **clear, maintainable, and DRY code** by default.
- Never inline utility functions in scripts, pages, or components.
- Order imports alphabetically and remove unused imports.
